<!DOCTYPE HTML>
<html>
	<head>
		<title>注册 - Timing</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<link rel="stylesheet" href="assets/css/navigation.css" />
		<link rel="stylesheet" href="assets/css/register-style.css" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
	</head>

	<body class="is-preload">
		<!-- Top Navigation Bar (exactly same as intro page) -->

		<!-- Wrapper (same as intro page for background consistency) -->
		<div id="wrapper">

		<!-- Main Register Container -->
		<div class="register-container">
			<div class="register-content">
				<button class="back-btn" id="back-btn" onclick="goBack()">←</button>
				<div class="page-indicator" id="page-indicator">1/2</div>
				
				<h1 class="register-title" id="register-title">欢迎来到Timing</h1>
				
				<form id="registerForm" action="#" method="post">
					<!-- Page 1: Basic Information -->
					<div class="form-page active" id="page1">
						<div class="form-group">
							<label for="username" id="userName-label">用户名</label>
							<input type="text" id="username" name="username" class="form-input" placeholder="">
						</div>
						
						<div class="form-group">
							<label for="email" id="email-label">邮箱</label>
							<input type="email" id="email" name="email" class="form-input" placeholder="">
						</div>
						
						<div class="form-group">
							<label for="password" id="password-label">密码</label>
							<input type="password" id="password" name="password" class="form-input" placeholder="">
						</div>
						
						<div class="form-group">
							<label for="confirmPassword" id="confirm-password-label">确认密码</label>
							<input type="password" id="confirmPassword" name="confirmPassword" class="form-input" placeholder="">

							<div class="password-warning" id="password-warning">不一致</div>
						</div>
						
						<div class="checkbox-forgot-row">
							<div class="checkbox-group">
								<input type="checkbox" id="agree" name="agree">

								<label for="agree" id="agree-label">同意服务条款</label>
							</div>
							
							<div class="forgot-password">
								<a href="#" id="termsLink">查看条款</a>
							</div>
						</div>
						
						<!-- <button type="button" class="form-register-btn" id="next-btn" onclick="nextPage()">确认</button> -->
						<button type="submit" class="form-register-btn" id="register-submit">注册</button>
					</div>

					<!-- Page 2: Verification information -->
					<div class="form-page" id="page2">
						<div class="form-group">
							<label for="username-verification" id="username-verification-label">用户名</label>
							<input type="text" id="username-verification" name="username-verification" class="form-input" placeholder="">
							<script>
								document.getElementById('username-verification').addEventListener('keydown', function(e){
									if(e.key == 'Enter') {
										e.preventDefault();
										document.getElementById('verification-submit').click();
									}
								})
							</script>
						</div>
						
						<div class="form-group">
							<label for="verification" id="verification-label">验证码</label>
							<div class="verification-group">
								<input type="text" id="verification" name="verification" class="form-input" placeholder="">
								<span class="verification-resend" id="verification-resend">重新发送</span>
								<script>
									document.getElementById('verification').addEventListener('keydown', function(e){
										if(e.key == 'Enter') {
											e.preventDefault();
											document.getElementById('verification-submit').click();
										}
									})
								</script>
							</div>
						</div>
						<button type="submit" class="form-register-btn" id="verification-submit">验证邮箱</button>
					</div>

				</form>
				
				<div class="login-link">
					<p id="login-text">已有账户？</p>
					<a href="#" id="login-link">立即登录</a>
				</div>
			</div>
		</div>

		</div>

		<!-- BG -->
		<div id="bg"></div>

				<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/auth.js"></script>
		<script>
			// Fallback to CDN if local file fails to load
			if (typeof jQuery === 'undefined') {
				document.write('<script src="https://code.jquery.com/jquery-3.6.0.min.js"><\/script>');
				// Additional fallback to a Chinese CDN
				document.write('<script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.6.0/jquery.min.js"><\/script>');
			}
		</script>
		<script src="assets/js/browser.min.js"></script>
		<script src="assets/js/breakpoints.min.js"></script>
		<script src="assets/js/util.js"></script>
		<script src="assets/js/main.js"></script>
		<!-- Navigation handling -->
		<script src="assets/js/navigation-loader.js"></script>
		<script src="assets/js/navigation.js"></script>
		
		<script>
			// Language detection and content switching
			let currentLanguage = 'zh'; // Default to Chinese
			
			// Detect language from URL parameters or referrer
			function detectLanguage() {
				const urlParams = new URLSearchParams(window.location.search);
				const langParam = urlParams.get('lang');
				
				// Priority 1: URL parameter
				if (langParam === 'en') {
					return 'en';
				} else if (langParam === 'zh') {
					return 'zh';
				}
				
				// Priority 2: Check referrer
				const referrer = document.referrer;
				if (referrer) {
					// Check if coming from English pages
					if (referrer.includes('index.html') && !referrer.includes('index-zh.html')) {
						return 'en';
					}
					// Check if coming from Chinese pages
					if (referrer.includes('index-zh.html')) {
						return 'zh';
					}
					// Check for language parameters in referrer
					if (referrer.includes('lang=en')) {
						return 'en';
					}
					if (referrer.includes('lang=zh')) {
						return 'zh';
					}
				}
				
				return 'zh'; // Default to Chinese
			}
			
			// Language content
			const content = {
				zh: {
					title: 'Timing - 注册',
					registerTitle: '欢迎来到Timing',
					userNameLabel: '用户名',
					userNamePlaceholder: '请输入您的用户名',
					userNameverificationLabel: '用户名或邮箱',
					userNameverificationPlaceholder: '请输入您的用户名或邮箱',
					emailLabel: '邮箱',
					emailPlaceholder: '请输入邮箱地址',
					verificationLabel: '验证码',
					verificationPlaceholder: '请输入验证码',
					verificationResend: '重新发送',
					passwordLabel: '密码',
					passwordPlaceholder: '请输入密码',
					confirmPasswordLabel: '确认密码',
					confirmPasswordPlaceholder: '请再次输入密码',
					passwordWarning: '不一致',
					agreeLabel: '同意服务条款',
					termsLink: '查看条款',
					nextBtn: '确认',
					birthtimeLabel: '出生时间',

					userAgreementLabel: '请阅读并同意用户协议和隐私政策',
					betaTesterLabel: '申请成为内测用户',
					registerSubmit: '注册',
					verificationSubmit: "验证邮箱",
					loginText: '已有账户？',
					loginLink: '立即登录',

				},
				en: {
					title: 'Timing - Register',
					registerTitle: 'Welcome to Timing',
					userNameLabel: 'Username',
					userNamePlaceholder: 'Please enter your username',
					userNameverificationLabel: 'Username or Email',
					userNameverificationPlaceholder: 'Please enter your username or email',
					emailLabel: 'Email',
					emailPlaceholder: 'Enter your email address',
					verificationLabel: 'Verification Code',
					verificationPlaceholder: 'Enter verification code',
					verificationResend: 'Resend',

					passwordLabel: 'Password',
					passwordPlaceholder: 'Enter your password',
					confirmPasswordLabel: 'Confirm Password',
					confirmPasswordPlaceholder: 'Enter your password again',
					passwordWarning: 'Mismatch',
					agreeLabel: 'Agree to Terms of Service',
					termsLink: 'View Terms',
					nextBtn: 'Confirm',


					userAgreementLabel: 'Please read and agree to the User Agreement and Privacy Policy',
					betaTesterLabel: 'Apply to become a beta tester',
					registerSubmit: 'Register',
					verificationSubmit: 'Verify Email',
					loginText: 'Already have an account?',
					loginLink: 'Sign In Now',

				}
			};
			
			// Update page content based on language
			function updateContent(lang) {
				currentLanguage = lang;
				const c = content[lang];
				
				// Update page title
				document.title = c.title;
				
				// Update form content
				document.getElementById('register-title').textContent = c.registerTitle;
				document.getElementById('userName-label').textContent = c.userNameLabel;
				document.getElementById('username').placeholder = c.userNamePlaceholder;
				document.getElementById('username-verification-label').textContent = c.userNameverificationLabel;
				document.getElementById('username-verification').placeholder = c.userNameverificationPlaceholder;

				document.getElementById('email-label').textContent = c.emailLabel;
				document.getElementById('email').placeholder = c.emailPlaceholder;
				document.getElementById('verification-label').textContent = c.verificationLabel;
				document.getElementById('verification').placeholder = c.verificationPlaceholder;
				document.getElementById('verification-resend').textContent = c.verificationResend;

				document.getElementById('password-label').textContent = c.passwordLabel;
				document.getElementById('password').placeholder = c.passwordPlaceholder;
				document.getElementById('confirm-password-label').textContent = c.confirmPasswordLabel;
				document.getElementById('confirmPassword').placeholder = c.confirmPasswordPlaceholder;
				document.getElementById('password-warning').textContent = c.passwordWarning;
				document.getElementById('agree-label').textContent = c.agreeLabel;
				document.getElementById('termsLink').textContent = c.termsLink;

				document.getElementById('register-submit').textContent = c.registerSubmit;
				document.getElementById('verification-submit').textContent = c.verificationSubmit;
				document.getElementById('login-text').textContent = c.loginText;
				document.getElementById('login-link').textContent = c.loginLink;
				
			}
			
			
			// Logo click handler
			function goToHomePage() {
				if (currentLanguage === 'zh') {
					window.location.href = 'index-zh.html';
				} else {
					window.location.href = 'index.html';
				}
			}

			// Password validation function
			function validatePassword() {
				const password = document.getElementById('password').value;
				const confirmPassword = document.getElementById('confirmPassword').value;
				const warning = document.getElementById('password-warning');
				
				if (confirmPassword && password !== confirmPassword) {
					warning.classList.add('show');
				} else {
					warning.classList.remove('show');
				}
			}
			
			// Page navigation variables
			let currentPage = 1;

			
			function goBack() {
				if (currentPage === 2) {
					// Switch to page 1
					document.getElementById('page2').classList.remove('active');
					document.getElementById('page1').classList.add('active');
					document.getElementById('page-indicator').textContent = '1/2';
					document.getElementById('back-btn').style.display = 'none';
					currentPage = 1;
				} else {
					// Go back to previous page or home page
					if (document.referrer && document.referrer.includes(window.location.origin)) {
						window.history.back();
					} else {
						const homePage = currentLanguage === 'en' ? 'index.html' : 'index-zh.html';
						window.location.href = homePage;
					}
				}
			}

			
			// Initialize language on page load
			document.addEventListener('DOMContentLoaded', function() {
				const detectedLang = detectLanguage();
				updateContent(detectedLang);
				
				// Add password validation listeners
				document.getElementById('password').addEventListener('input', validatePassword);
				document.getElementById('confirmPassword').addEventListener('input', validatePassword);
			});			
			
			// Terms link handling
			document.getElementById('termsLink').addEventListener('click', function(e) {
				e.preventDefault();
				const message = currentLanguage === 'zh' ? '服务条款功能将在后端完成后启用' : 'Terms of service functionality will be enabled after backend completion';
				alert(message);
			});
			
			// Login link handling
			document.getElementById('login-link').addEventListener('click', function(e) {
				e.preventDefault();
				// Navigate to login page with current language
				window.location.href = `login.html?lang=${currentLanguage}`;
			});
			
			// Verification resend handling
			// document.getElementById('verification-resend').addEventListener('click', function() {
			// 	const message = currentLanguage === 'zh' ? '验证码已发送' : 'Verification code sent';
			// 	alert(message);
			// });
		</script>
	</body>
</html> 